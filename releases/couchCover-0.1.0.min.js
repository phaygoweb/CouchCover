(function(){var c={version:"0.1.0",init:function(a){for(var b in a)c.hasOwnProperty(b)||(c[b]=a[b])},xhr:function(a,b,e){var d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(!d)return!1;a.url=c.host+"/"+a.url;if(typeof a.method=="undefined")a.method="GET";d.onreadystatechange=function(){if(d.readyState===4&&d.status===200)if(e)e(d);else return d};d.open(a.method,a.url,!0);(a.method==="PUT"||a.method==="POST")&&d.setRequestHeader("Content-Type","application/json");
b!==""?d.send(b):d.send(null)}};c.database={create:function(a,b){c.xhr({url:a.db,method:"PUT"},null,function(a){b&&b(a.responseText)})},"delete":function(a,b){c.xhr({url:a.db,method:"DELETE"},null,function(a){b&&b(a.responseText)})},viewAll:function(a,b){c.xhr({url:"_all_dbs"},null,function(a){b&&b(a.responseText)})},view:function(a,b){c.xhr({url:a.db},null,function(a){b&&b(a.responseText)})}};c.doc={create:function(a,b,e){a.docId||console.error("No docId provided, need to generate a UUID.");c.xhr({url:a.db+
"/"+a.docId,method:"PUT"},b,function(a){e&&e(a.responseText)})},"delete":function(a,b){var e=a.db+"/"+a.docId;a.docRev?e+="?rev="+a.docRev:c.doc.revision({db:a.db,docId:a.docId},function(a){e+="?rev="+a;c.xhr({url:e,method:"DELETE"},null,function(a){b&&b(a.responseText)})})},addField:function(a,b,e){var d=a.db+"/"+a.docId,f=JSON.parse(b);f._rev?c.xhr({url:d,method:"PUT"},b,function(a){e&&e(a.responseText)}):c.doc.revision(a,function(a){f._rev=a;b=JSON.stringify(f);c.xhr({url:d,method:"PUT"},b,function(a){e&&
e(a.responseText)})})},removeField:function(a,b){var e=a.db+"/"+a.docId;c.xhr({url:e},null,function(d){for(var d=JSON.parse(d.responseText),f=a.remove.split(","),h=f.length,g=0,g=0;g<h;g++)f[g]=f[g].replace(/^(\s)/i,"").replace(/(\s)$/i,""),delete d[f[g]];c.xhr({url:e,method:"PUT"},JSON.stringify(d),function(a){b&&b(a.responseText)})})},view:function(a,b){c.xhr({url:a.db+"/"+a.docId},null,function(a){b&&b(a.responseText)})},revision:function(a,b){c.xhr({url:a.db+"/"+a.docId,method:"HEAD"},null,function(a){b&&
b(a.getResponseHeader("Etag").replace(/"/gi,""))})}};window.couchCover=window.cc$=c;console.log("CouchCover "+c.version+" initialized")})(window);